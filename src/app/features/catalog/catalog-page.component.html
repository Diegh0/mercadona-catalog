<section class="catalog" aria-label="Catálogo">
  <div class="mobile-tabs">
  <button type="button" class="tab" [class.active]="showLeft()" (click)="mobileTab.set('left')">
    Categorías
  </button>
  <button type="button" class="tab" [class.active]="showRight()" (click)="mobileTab.set('right')">
    Productos
  </button>
</div>

  <div
  #leftCol
  class="col left"
  [class.hide-mobile]="showRight()"
  aria-label="Columna izquierda"
  (scroll)="store.setLeftScrollTop(($any($event.target)).scrollTop)"
>

    <h2 class="section-title">Categorías</h2>

    @if (store.loading()) {
      <div class="placeholder">Cargando categorías...</div>
    } @else {
      <app-category-list
        [categories]="store.categories()"
        [selectedCategoryId]="store.selectedCategoryId()"
        (selectCategory)="onSelectCategory($event)"
      />
    }
    @if (store.productPath().length > 0) {
      <h3 class="subtitle">Selección</h3>

      <div class="path">
        @for (p of store.productPath(); track p.id) {
          <div class="path-item">{{ p.name }}</div>
        }
      </div>
}

  </div>

<div
  #rightCol
  class="col right"
  aria-label="Columna derecha"
  (scroll)="store.setRightScrollTop(($any($event.target)).scrollTop)"
>

  @if (store.selectedCategoryId() === null) {
    <div class="empty-state">Seleccione una categoría</div>
  } @else {
    <div class="right-header">
  <h2 class="section-title">Productos</h2>

  <div class="right-actions">
    <button type="button" class="btn btn--brand" (click)="onToggleSort()">
  {{ store.sortConfig().filterName }} {{ sortArrow() }}
</button>


    <app-back-button
      [visible]="store.hasProductSelected()"
      (back)="onBack()"
    />
  </div>
</div>


    <!-- BUSCADOR: -->
    @if (store.showSearch()) {
      <div class="search">
        <input
          type="text"
          class="search-input"
          placeholder="Buscar producto..."
          [value]="store.searchTerm()"
          (input)="store.searchTerm.set(($any($event.target)).value)"
        />

        @if (store.searchTerm().trim().length > 0 && store.searchTerm().trim().length < 3) {
          <div class="search-hint">Escribe al menos 3 caracteres</div>
        }
      </div>
    }

    <app-product-list
    [products]="store.rightProductsView()"
    (selectProduct)="onSelectProduct($event)"
    />

  }
</div>
</section>
